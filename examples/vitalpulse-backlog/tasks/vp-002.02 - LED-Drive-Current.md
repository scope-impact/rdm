---
id: vp-002.02
title: "LED Drive Current Control"
status: To Do
assignee: []
created_date: '2026-01-18'
updated_date: '2026-01-18'
labels:
  - vp-002.02
  - spo2
  - sensors
  - led
  - calibration
dependencies:
  - vp-002.01
parent_task_id: vp-002
ordinal: 2000
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
As a **Firmware engineer**, I want to **implement automatic LED drive current control** so that I can **maintain optimal signal amplitude across varying skin pigmentation and perfusion levels**.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria

<!-- AC:BEGIN -->
- [ ] #1 LED current adjustable from 0-50mA in 1mA steps
- [ ] #2 AGC algorithm maintains signal amplitude within ADC range (10-90%)
- [ ] #3 Current adjustment completes within 5 heartbeats
- [ ] #4 Separate current control for red and IR LEDs
- [ ] #5 Current limits enforced to prevent LED damage (<50mA)
- [ ] #6 Low perfusion detected when max current insufficient
<!-- AC:END -->

## Implementation Notes

<!-- SECTION:NOTES:BEGIN -->
- **LED Types:** Red (660nm), IR (940nm)
- **AGC:** Automatic gain control adjusts LED current to optimize SNR
- **Why:** Skin pigmentation varies signal absorption significantly
- **IEC 80601-2-61:** Performance must be maintained across patient population
<!-- SECTION:NOTES:END -->
